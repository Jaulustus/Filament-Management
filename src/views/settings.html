<section class="panel" data-page="settings">
  <header class="panel__title">
    <h1>{{t 'settings_title'}}</h1>
  </header>

  {{#if saved}}
    <p class="form__hint form__hint--success">{{t 'settings_saved'}}</p>
  {{else}}
    <p class="form__hint form__hint--warn" data-settings-warning hidden>{{t 'settings_unsaved_warning'}}</p>
  {{/if}}

  <form method="post" class="form settings-form" data-settings-form data-leave-warning="{{t 'settings_unsaved_warning'}}">
    <div class="settings-search">
      <label>
        <span>{{t 'settings_search_label'}}</span>
        <input type="search" name="settingsSearch" placeholder="{{t 'settings_search_placeholder'}}" autocomplete="off" data-settings-search>
      </label>
    </div>

    <section class="settings-group" data-settings-group>
      <header class="settings-group__header">
        <h2>{{t 'settings_group_filament'}}</h2>
        <p>{{t 'settings_group_filament_hint'}}</p>
      </header>
      <div class="settings-group__body">
        <section class="settings-card" data-settings-card>
          <header class="settings-card__header">
            <h3>{{t 'settings_required_fields'}}</h3>
            <p class="settings-card__hint">{{t 'settings_required_fields_hint'}}</p>
          </header>
          <div class="settings-grid">
            {{#each requiredFieldDefs}}
              <label class="checkbox">
                <input type="checkbox" name="requiredFields[{{this.key}}]" {{#if (lookup ../config.requiredFields this.key)}}checked{{/if}}>
                <span>{{t this.labelKey}}</span>
              </label>
            {{/each}}
          </div>
        </section>

        <section class="settings-card" data-settings-card>
          <header class="settings-card__header">
            <h3>{{t 'settings_print_profile_title'}}</h3>
            <p class="settings-card__hint">{{t 'settings_print_profile_hint'}}</p>
          </header>
          <div class="settings-grid settings-grid--small">
            <label>
              <span>{{t 'settings_print_profile_label'}}</span>
              <select name="activePrintProfile">
                {{#each printProfiles}}
                  <option value="{{@key}}" {{#if (eq ../../config.activePrintProfile @key)}}selected{{/if}}>{{this.name}}</option>
                {{/each}}
              </select>
            </label>
          </div>
        </section>

        <section class="settings-card" data-settings-card>
          <header class="settings-card__header">
            <h3>{{t 'settings_units'}}</h3>
            <p class="settings-card__hint">{{t 'settings_units_hint'}}</p>
          </header>
          <div class="settings-grid settings-grid--small">
            <label>
              <span>{{t 'settings_currency'}}</span>
              <select name="currency">
                {{#each currencyOptions}}
                  <option value="{{this.value}}" {{#if (eq ../config.currency this.value)}}selected{{/if}}>{{this.label}}</option>
                {{/each}}
              </select>
            </label>
            <label>
              <span>{{t 'settings_length_unit'}}</span>
              <select name="lengthUnit">
                {{#each lengthOptions}}
                  <option value="{{this.value}}" {{#if (eq ../config.lengthUnit this.value)}}selected{{/if}}>{{this.label}}</option>
                {{/each}}
              </select>
            </label>
            <label>
              <span>{{t 'settings_weight_unit'}}</span>
              <select name="weightUnit">
                {{#each weightOptions}}
                  <option value="{{this.value}}" {{#if (eq ../config.weightUnit this.value)}}selected{{/if}}>{{this.label}}</option>
                {{/each}}
              </select>
            </label>
            <label>
              <span>{{t 'settings_label_barcode_width'}} ({{ui.form.units.length}})</span>
              <input type="number" step="0.1" min="1" name="labelBarcodeWidth" value="{{ui.form.labelSizes.barcodeWidth}}">
            </label>
            <label>
              <span>{{t 'settings_label_barcode_height'}} ({{ui.form.units.length}})</span>
              <input type="number" step="0.1" min="1" name="labelBarcodeHeight" value="{{ui.form.labelSizes.barcodeHeight}}">
            </label>
            <label>
              <span>{{t 'settings_label_qr_size'}} ({{ui.form.units.length}})</span>
              <input type="number" step="0.1" min="1" name="labelQrSize" value="{{ui.form.labelSizes.qrSize}}">
            </label>
          </div>
        </section>
      </div>
    </section>

    <section class="settings-group" data-settings-group>
      <header class="settings-group__header">
        <h2>{{t 'settings_group_inventory'}}</h2>
        <p>{{t 'settings_group_inventory_hint'}}</p>
      </header>
      <div class="settings-group__body">
        <section class="settings-card" data-settings-card data-area-manager>
          <header class="settings-card__header">
            <h3>{{t 'settings_inventory_areas_title'}}</h3>
            <p class="settings-card__hint">{{t 'settings_inventory_areas_hint'}}</p>
          </header>
          <div class="settings-area-manager">
            <label class="settings-area-input">
              <span>{{t 'settings_inventory_area_input_label'}}</span>
              <div class="settings-area-input__row">
                <input type="text" data-area-input placeholder="{{t 'settings_inventory_area_input_placeholder'}}" autocomplete="off">
                <button type="button" class="btn" data-area-add>{{t 'settings_inventory_area_add'}}</button>
              </div>
            </label>
            <div class="settings-area-list" data-area-list data-empty-text="{{t 'settings_inventory_area_empty'}}">
              {{#each inventoryAreasList}}
                <span class="settings-area-chip" data-area-item>
                  <span class="settings-area-chip__label">{{this}}</span>
                  <button type="button" class="settings-area-chip__remove" data-area-remove aria-label="{{t 'settings_inventory_area_remove'}}">Ã—</button>
                </span>
              {{/each}}
            </div>
            <input type="hidden" name="inventoryAreas" data-area-hidden value="{{inventoryAreasText}}">
          </div>
        </section>

        <section class="settings-card" data-settings-card>
          <header class="settings-card__header">
            <h3>{{t 'settings_inventory_options_title'}}</h3>
            <p class="settings-card__hint">{{t 'settings_inventory_include_filaments_hint'}}</p>
          </header>
          <label class="checkbox">
            <input type="checkbox" name="includeFilamentsInInventoryReport" value="1" {{#if includeFilamentsInInventoryReport}}checked{{/if}}>
            <span>{{t 'settings_inventory_include_filaments_label'}}</span>
          </label>
        </section>
      </div>
    </section>

    <footer class="form__actions">
      <button type="submit" class="btn">{{t 'settings_save'}}</button>
    </footer>
  </form>

  <section class="settings-hint">
    <h2>{{t 'settings_more_title'}}</h2>
    <p>{{t 'settings_more_text'}}</p>
  </section>
</section>

