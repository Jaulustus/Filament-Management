<!DOCTYPE html>
<html lang="{{lang}}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{t 'app_title'}}</title>
  <link rel="icon" type="image/x-icon" href="/assets/icons/Filahub32.ico">
  <link rel="shortcut icon" type="image/x-icon" href="/assets/icons/Filahub32.ico">
  <link rel="stylesheet" href="/styles.css">
</head>
<body data-lang="{{lang}}" data-length-unit="{{ui.form.units.length}}" data-weight-unit="{{ui.form.units.weight}}" data-currency="{{ui.form.currency}}">
  <header class="topbar">
    <div class="topbar__title">
      {{#if topbarLogoKey}}
        <span class="topbar__logo">{{t topbarLogoKey}}</span>
        {{#unless (eq topbarLogoKey topbarBrandKey)}}
          <a href="/">{{t topbarBrandKey}}</a>
        {{/unless}}
      {{else}}
        <a href="/">{{t topbarBrandKey}}</a>
      {{/if}}
    </div>
    <nav class="topbar__nav">
      {{#each navLinks}}
        <a href="{{this.href}}">{{t this.labelKey}}</a>
      {{/each}}
    </nav>
    <div class="topbar__actions">
      {{#if showLanguageSwitcher}}
        <div class="topbar__language">
          <span>{{t 'language'}}:</span>
          {{#each languages}}
            <a class="lang-link {{#if (eq ../lang this)}}active{{/if}}" href="?lang={{this}}">{{uppercase this}}</a>
          {{/each}}
        </div>
      {{/if}}
    </div>
  </header>

  <main class="main">
    {{{body}}}
  </main>

  <div class="modal-backdrop" id="code-modal-backdrop" hidden></div>
  <div class="modal" id="code-modal" hidden role="dialog" aria-modal="true" aria-labelledby="code-modal-title">
    <div class="modal__dialog">
      <button type="button" class="modal__close" data-modal-close aria-label="{{t 'modal_close'}}">Ã—</button>
      <header class="modal__header">
        <h2 id="code-modal-title">{{t 'modal_codes_title'}}</h2>
        <p class="modal__subtitle">{{t 'modal_codes_subtitle'}}</p>
      </header>
      <div class="modal__controls" role="group" aria-label="{{t 'modal_codes_filter_label'}}">
        <button type="button" class="btn btn--ghost btn--small is-active" data-code-filter="both">{{t 'modal_codes_filter_both'}}</button>
        <button type="button" class="btn btn--ghost btn--small" data-code-filter="barcode">{{t 'modal_codes_filter_barcode'}}</button>
        <button type="button" class="btn btn--ghost btn--small" data-code-filter="qr">{{t 'modal_codes_filter_qr'}}</button>
      </div>
      <div class="modal__body">
        <div class="code-preview" data-code-block="barcode">
          <img data-barcode src="" alt="{{t 'modal_barcode_alt'}}">
          <span class="code-preview__label">{{t 'barcode'}}</span>
        </div>
        <div class="code-preview" data-code-block="qr">
          <img data-qr src="" alt="{{t 'modal_qr_alt'}}">
          <span class="code-preview__label">{{t 'qrcode'}}</span>
        </div>
      </div>
      <footer class="modal__footer">
        <button type="button" class="btn" data-modal-print>{{t 'modal_codes_print'}}</button>
      </footer>
    </div>
  </div>

  <script id="translations-data" type="application/json">
    {{{json translationStrings}}}
  </script>
  <script id="print-profile-data" type="application/json">
    {{{json printProfile}}}
  </script>
  <script>
    window.__LANG__ = "{{lang}}";
    (function () {
      const node = document.getElementById('translations-data');
      if (!node) {
        window.__T__ = {};
        return;
      }
      try {
        window.__T__ = JSON.parse(node.textContent || '{}');
      } catch (error) {
        console.warn('Failed to parse translations', error);
        window.__T__ = {};
      }
    })();
    (function () {
      const node = document.getElementById('print-profile-data');
      if (!node) {
        window.__PRINT_PROFILE__ = null;
        return;
      }
      try {
        window.__PRINT_PROFILE__ = JSON.parse(node.textContent || 'null');
      } catch (error) {
        console.warn('Failed to parse print profile', error);
        window.__PRINT_PROFILE__ = null;
      }
    })();
  </script>
  <!-- DYMO Label Framework - wird von DYMO Connect installiert -->
  <script src="https://labelwriter.com/software/dls/sdk/js/dymo.label.framework.8.5.2.js" defer onerror="console.warn('DYMO Label Framework konnte nicht geladen werden. Bitte DYMO Connect installieren.')"></script>
  <script src="/js/app.js" defer></script>
</body>
</html>

